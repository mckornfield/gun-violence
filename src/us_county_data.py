"""Embedded US county-level data and getter functions for gun violence analysis.

Covers ~100 of the largest US counties by population. Data sources:
- CDC WONDER (gun homicide rates, ~2020-2022)
- Census ACS 2022 (population, Gini, poverty rate, median income)
- FBI UCR (drug offense rates, ~2020)
- RAND Corporation (state-level gun ownership estimates)
- Giffords Law Center (state-level gun law grades, 2023)

Join key: 5-digit FIPS code (zero-padded string, e.g. "06037").
"""

import pandas as pd
import numpy as np


# ---------------------------------------------------------------------------
# County-level data — keyed by 5-digit FIPS
# Format: fips -> (county_name, state_abbr, value)
# ---------------------------------------------------------------------------

# Gun homicide rate per 100K (CDC WONDER, ~2020-2022 average)
_COUNTY_GUN_HOMICIDE = {
    "06037": ("Los Angeles County", "CA", 7.2),
    "17031": ("Cook County", "IL", 14.5),
    "48201": ("Harris County", "TX", 12.8),
    "04013": ("Maricopa County", "AZ", 7.1),
    "06073": ("San Diego County", "CA", 3.5),
    "06059": ("Orange County", "CA", 1.8),
    "12086": ("Miami-Dade County", "FL", 10.2),
    "48113": ("Dallas County", "TX", 11.4),
    "36047": ("Kings County", "NY", 4.8),
    "06065": ("Riverside County", "CA", 5.6),
    "04019": ("Pima County", "AZ", 6.8),
    "36081": ("Queens County", "NY", 2.5),
    "26163": ("Wayne County", "MI", 22.5),
    "06071": ("San Bernardino County", "CA", 7.8),
    "53033": ("King County", "WA", 3.9),
    "12011": ("Broward County", "FL", 6.1),
    "48029": ("Bexar County", "TX", 9.3),
    "06001": ("Alameda County", "CA", 6.4),
    "42101": ("Philadelphia County", "PA", 20.1),
    "48439": ("Tarrant County", "TX", 7.5),
    "36061": ("New York County", "NY", 2.1),
    "06085": ("Santa Clara County", "CA", 1.9),
    "12031": ("Duval County", "FL", 12.3),
    "12099": ("Palm Beach County", "FL", 5.8),
    "06067": ("Sacramento County", "CA", 8.1),
    "47157": ("Shelby County", "TN", 23.4),
    "29510": ("St. Louis City", "MO", 28.1),
    "29189": ("St. Louis County", "MO", 7.2),
    "13121": ("Fulton County", "GA", 13.9),
    "27053": ("Hennepin County", "MN", 5.4),
    "39035": ("Cuyahoga County", "OH", 11.8),
    "48141": ("El Paso County", "TX", 2.9),
    "55079": ("Milwaukee County", "WI", 16.4),
    "12057": ("Hillsborough County", "FL", 7.3),
    "37119": ("Mecklenburg County", "NC", 9.2),
    "06077": ("San Joaquin County", "CA", 9.8),
    "32003": ("Clark County", "NV", 8.4),
    "24510": ("Baltimore City", "MD", 34.2),
    "24005": ("Baltimore County", "MD", 4.9),
    "48453": ("Travis County", "TX", 4.6),
    "39049": ("Franklin County", "OH", 10.1),
    "06019": ("Fresno County", "CA", 8.5),
    "13089": ("DeKalb County", "GA", 10.4),
    "36005": ("Bronx County", "NY", 5.2),
    "12095": ("Orange County", "FL", 6.9),
    "18097": ("Marion County", "IN", 18.7),
    "39061": ("Hamilton County", "OH", 9.6),
    "51059": ("Fairfax County", "VA", 1.1),
    "48085": ("Collin County", "TX", 0.9),
    "06081": ("San Mateo County", "CA", 1.3),
    "06013": ("Contra Costa County", "CA", 4.7),
    "26125": ("Oakland County", "MI", 2.8),
    "12103": ("Pinellas County", "FL", 4.4),
    "08041": ("El Paso County", "CO", 3.7),
    "08031": ("Denver County", "CO", 8.9),
    "08001": ("Adams County", "CO", 5.2),
    "48215": ("Hidalgo County", "TX", 3.1),
    "21111": ("Jefferson County", "KY", 13.1),
    "01073": ("Jefferson County", "AL", 18.2),
    "40109": ("Oklahoma County", "OK", 14.3),
    "40143": ("Tulsa County", "OK", 11.6),
    "45091": ("York County", "SC", 3.4),
    "47037": ("Davidson County", "TN", 12.4),
    "22071": ("Orleans Parish", "LA", 29.8),
    "22033": ("East Baton Rouge Parish", "LA", 17.1),
    "51760": ("Richmond City", "VA", 16.8),
    "51810": ("Virginia Beach City", "VA", 3.0),
    "34013": ("Essex County", "NJ", 8.1),
    "34017": ("Hudson County", "NJ", 3.7),
    "34023": ("Middlesex County", "NJ", 1.2),
    "09003": ("Hartford County", "CT", 4.5),
    "09001": ("Fairfield County", "CT", 2.6),
    "25017": ("Middlesex County", "MA", 0.7),
    "25025": ("Suffolk County", "MA", 5.1),
    "25013": ("Hampden County", "MA", 4.9),
    "37183": ("Wake County", "NC", 3.8),
    "37063": ("Durham County", "NC", 11.7),
    "48355": ("Nueces County", "TX", 5.8),
    "53053": ("Pierce County", "WA", 5.5),
    "41051": ("Multnomah County", "OR", 6.2),
    "41005": ("Clackamas County", "OR", 1.4),
    "28049": ("Hinds County", "MS", 30.5),
    "05119": ("Pulaski County", "AR", 15.4),
    "01097": ("Mobile County", "AL", 14.8),
    "12001": ("Alachua County", "FL", 6.0),
    "20173": ("Sedgwick County", "KS", 8.7),
    "31055": ("Douglas County", "NE", 6.3),
    "19153": ("Polk County", "IA", 3.2),
    "46099": ("Minnehaha County", "SD", 2.4),
    "38017": ("Cass County", "ND", 1.5),
    "30111": ("Yellowstone County", "MT", 3.1),
    "56021": ("Laramie County", "WY", 2.2),
    "16001": ("Ada County", "ID", 2.0),
    "49035": ("Salt Lake County", "UT", 3.0),
    "33011": ("Hillsborough County", "NH", 1.8),
    "50007": ("Chittenden County", "VT", 0.9),
    "10003": ("New Castle County", "DE", 7.4),
    "44007": ("Providence County", "RI", 3.6),
    "15003": ("Honolulu County", "HI", 1.0),
    "02020": ("Anchorage Municipality", "AK", 5.8),
    "11001": ("District of Columbia", "DC", 18.5),
}

# Population (Census ACS 2022 estimates)
_COUNTY_POPULATION = {
    "06037": ("Los Angeles County", "CA", 9829544),
    "17031": ("Cook County", "IL", 5173146),
    "48201": ("Harris County", "TX", 4728030),
    "04013": ("Maricopa County", "AZ", 4496588),
    "06073": ("San Diego County", "CA", 3276208),
    "06059": ("Orange County", "CA", 3162245),
    "12086": ("Miami-Dade County", "FL", 2701767),
    "48113": ("Dallas County", "TX", 2613539),
    "36047": ("Kings County", "NY", 2559903),
    "06065": ("Riverside County", "CA", 2418185),
    "04019": ("Pima County", "AZ", 1043433),
    "36081": ("Queens County", "NY", 2270976),
    "26163": ("Wayne County", "MI", 1749343),
    "06071": ("San Bernardino County", "CA", 2171603),
    "53033": ("King County", "WA", 2269675),
    "12011": ("Broward County", "FL", 1944375),
    "48029": ("Bexar County", "TX", 2009324),
    "06001": ("Alameda County", "CA", 1637753),
    "42101": ("Philadelphia County", "PA", 1567258),
    "48439": ("Tarrant County", "TX", 2110640),
    "36061": ("New York County", "NY", 1596273),
    "06085": ("Santa Clara County", "CA", 1870945),
    "12031": ("Duval County", "FL", 995567),
    "12099": ("Palm Beach County", "FL", 1492191),
    "06067": ("Sacramento County", "CA", 1552058),
    "47157": ("Shelby County", "TN", 927641),
    "29510": ("St. Louis City", "MO", 293310),
    "29189": ("St. Louis County", "MO", 1004125),
    "13121": ("Fulton County", "GA", 1066710),
    "27053": ("Hennepin County", "MN", 1281565),
    "39035": ("Cuyahoga County", "OH", 1235072),
    "48141": ("El Paso County", "TX", 865657),
    "55079": ("Milwaukee County", "WI", 929566),
    "12057": ("Hillsborough County", "FL", 1459762),
    "37119": ("Mecklenburg County", "NC", 1151610),
    "06077": ("San Joaquin County", "CA", 779233),
    "32003": ("Clark County", "NV", 2265461),
    "24510": ("Baltimore City", "MD", 576498),
    "24005": ("Baltimore County", "MD", 850737),
    "48453": ("Travis County", "TX", 1290188),
    "39049": ("Franklin County", "OH", 1323807),
    "06019": ("Fresno County", "CA", 1008654),
    "13089": ("DeKalb County", "GA", 764382),
    "36005": ("Bronx County", "NY", 1379946),
    "12095": ("Orange County", "FL", 1429908),
    "18097": ("Marion County", "IN", 977203),
    "39061": ("Hamilton County", "OH", 830639),
    "51059": ("Fairfax County", "VA", 1150309),
    "48085": ("Collin County", "TX", 1064465),
    "06081": ("San Mateo County", "CA", 737888),
    "06013": ("Contra Costa County", "CA", 1153561),
    "26125": ("Oakland County", "MI", 1274395),
    "12103": ("Pinellas County", "FL", 959107),
    "08041": ("El Paso County", "CO", 730395),
    "08031": ("Denver County", "CO", 713252),
    "08001": ("Adams County", "CO", 519572),
    "48215": ("Hidalgo County", "TX", 870781),
    "21111": ("Jefferson County", "KY", 782969),
    "01073": ("Jefferson County", "AL", 658573),
    "40109": ("Oklahoma County", "OK", 796292),
    "40143": ("Tulsa County", "OK", 669279),
    "45091": ("York County", "SC", 287152),
    "47037": ("Davidson County", "TN", 715884),
    "22071": ("Orleans Parish", "LA", 383997),
    "22033": ("East Baton Rouge Parish", "LA", 456781),
    "51760": ("Richmond City", "VA", 226610),
    "51810": ("Virginia Beach City", "VA", 459470),
    "34013": ("Essex County", "NJ", 850897),
    "34017": ("Hudson County", "NJ", 724854),
    "34023": ("Middlesex County", "NJ", 863162),
    "09003": ("Hartford County", "CT", 896521),
    "09001": ("Fairfield County", "CT", 943332),
    "25017": ("Middlesex County", "MA", 1632002),
    "25025": ("Suffolk County", "MA", 797936),
    "25013": ("Hampden County", "MA", 466552),
    "37183": ("Wake County", "NC", 1129410),
    "37063": ("Durham County", "NC", 324833),
    "48355": ("Nueces County", "TX", 353178),
    "53053": ("Pierce County", "WA", 921130),
    "41051": ("Multnomah County", "OR", 808459),
    "41005": ("Clackamas County", "OR", 421401),
    "28049": ("Hinds County", "MS", 227742),
    "05119": ("Pulaski County", "AR", 399125),
    "01097": ("Mobile County", "AL", 414809),
    "12001": ("Alachua County", "FL", 283076),
    "20173": ("Sedgwick County", "KS", 523824),
    "31055": ("Douglas County", "NE", 584526),
    "19153": ("Polk County", "IA", 492401),
    "46099": ("Minnehaha County", "SD", 197803),
    "38017": ("Cass County", "ND", 185345),
    "30111": ("Yellowstone County", "MT", 164731),
    "56021": ("Laramie County", "WY", 99500),
    "16001": ("Ada County", "ID", 506529),
    "49035": ("Salt Lake County", "UT", 1185238),
    "33011": ("Hillsborough County", "NH", 421937),
    "50007": ("Chittenden County", "VT", 168323),
    "10003": ("New Castle County", "DE", 570719),
    "44007": ("Providence County", "RI", 660741),
    "15003": ("Honolulu County", "HI", 1000890),
    "02020": ("Anchorage Municipality", "AK", 291247),
    "11001": ("District of Columbia", "DC", 671803),
}

# Gini coefficient (Census ACS 2022)
_COUNTY_GINI = {
    "06037": ("Los Angeles County", "CA", 0.507),
    "17031": ("Cook County", "IL", 0.504),
    "48201": ("Harris County", "TX", 0.498),
    "04013": ("Maricopa County", "AZ", 0.460),
    "06073": ("San Diego County", "CA", 0.465),
    "06059": ("Orange County", "CA", 0.465),
    "12086": ("Miami-Dade County", "FL", 0.512),
    "48113": ("Dallas County", "TX", 0.504),
    "36047": ("Kings County", "NY", 0.512),
    "06065": ("Riverside County", "CA", 0.435),
    "04019": ("Pima County", "AZ", 0.462),
    "36081": ("Queens County", "NY", 0.461),
    "26163": ("Wayne County", "MI", 0.503),
    "06071": ("San Bernardino County", "CA", 0.432),
    "53033": ("King County", "WA", 0.472),
    "12011": ("Broward County", "FL", 0.472),
    "48029": ("Bexar County", "TX", 0.466),
    "06001": ("Alameda County", "CA", 0.490),
    "42101": ("Philadelphia County", "PA", 0.518),
    "48439": ("Tarrant County", "TX", 0.448),
    "36061": ("New York County", "NY", 0.600),
    "06085": ("Santa Clara County", "CA", 0.470),
    "12031": ("Duval County", "FL", 0.468),
    "12099": ("Palm Beach County", "FL", 0.513),
    "06067": ("Sacramento County", "CA", 0.457),
    "47157": ("Shelby County", "TN", 0.506),
    "29510": ("St. Louis City", "MO", 0.536),
    "29189": ("St. Louis County", "MO", 0.467),
    "13121": ("Fulton County", "GA", 0.546),
    "27053": ("Hennepin County", "MN", 0.469),
    "39035": ("Cuyahoga County", "OH", 0.497),
    "48141": ("El Paso County", "TX", 0.420),
    "55079": ("Milwaukee County", "WI", 0.489),
    "12057": ("Hillsborough County", "FL", 0.462),
    "37119": ("Mecklenburg County", "NC", 0.484),
    "06077": ("San Joaquin County", "CA", 0.441),
    "32003": ("Clark County", "NV", 0.441),
    "24510": ("Baltimore City", "MD", 0.518),
    "24005": ("Baltimore County", "MD", 0.440),
    "48453": ("Travis County", "TX", 0.489),
    "39049": ("Franklin County", "OH", 0.479),
    "06019": ("Fresno County", "CA", 0.468),
    "13089": ("DeKalb County", "GA", 0.487),
    "36005": ("Bronx County", "NY", 0.468),
    "12095": ("Orange County", "FL", 0.460),
    "18097": ("Marion County", "IN", 0.480),
    "39061": ("Hamilton County", "OH", 0.494),
    "51059": ("Fairfax County", "VA", 0.415),
    "48085": ("Collin County", "TX", 0.405),
    "06081": ("San Mateo County", "CA", 0.462),
    "06013": ("Contra Costa County", "CA", 0.453),
    "26125": ("Oakland County", "MI", 0.441),
    "12103": ("Pinellas County", "FL", 0.471),
    "08041": ("El Paso County", "CO", 0.420),
    "08031": ("Denver County", "CO", 0.493),
    "08001": ("Adams County", "CO", 0.394),
    "48215": ("Hidalgo County", "TX", 0.444),
    "21111": ("Jefferson County", "KY", 0.481),
    "01073": ("Jefferson County", "AL", 0.497),
    "40109": ("Oklahoma County", "OK", 0.481),
    "40143": ("Tulsa County", "OK", 0.474),
    "45091": ("York County", "SC", 0.396),
    "47037": ("Davidson County", "TN", 0.497),
    "22071": ("Orleans Parish", "LA", 0.541),
    "22033": ("East Baton Rouge Parish", "LA", 0.497),
    "51760": ("Richmond City", "VA", 0.528),
    "51810": ("Virginia Beach City", "VA", 0.393),
    "34013": ("Essex County", "NJ", 0.508),
    "34017": ("Hudson County", "NJ", 0.493),
    "34023": ("Middlesex County", "NJ", 0.431),
    "09003": ("Hartford County", "CT", 0.496),
    "09001": ("Fairfield County", "CT", 0.531),
    "25017": ("Middlesex County", "MA", 0.459),
    "25025": ("Suffolk County", "MA", 0.533),
    "25013": ("Hampden County", "MA", 0.475),
    "37183": ("Wake County", "NC", 0.447),
    "37063": ("Durham County", "NC", 0.488),
    "48355": ("Nueces County", "TX", 0.453),
    "53053": ("Pierce County", "WA", 0.420),
    "41051": ("Multnomah County", "OR", 0.491),
    "41005": ("Clackamas County", "OR", 0.406),
    "28049": ("Hinds County", "MS", 0.529),
    "05119": ("Pulaski County", "AR", 0.485),
    "01097": ("Mobile County", "AL", 0.475),
    "12001": ("Alachua County", "FL", 0.495),
    "20173": ("Sedgwick County", "KS", 0.444),
    "31055": ("Douglas County", "NE", 0.431),
    "19153": ("Polk County", "IA", 0.428),
    "46099": ("Minnehaha County", "SD", 0.412),
    "38017": ("Cass County", "ND", 0.418),
    "30111": ("Yellowstone County", "MT", 0.423),
    "56021": ("Laramie County", "WY", 0.404),
    "16001": ("Ada County", "ID", 0.421),
    "49035": ("Salt Lake County", "UT", 0.420),
    "33011": ("Hillsborough County", "NH", 0.423),
    "50007": ("Chittenden County", "VT", 0.435),
    "10003": ("New Castle County", "DE", 0.456),
    "44007": ("Providence County", "RI", 0.478),
    "15003": ("Honolulu County", "HI", 0.437),
    "02020": ("Anchorage Municipality", "AK", 0.407),
    "11001": ("District of Columbia", "DC", 0.551),
}

# Drug offense rate per 100K (FBI UCR, ~2020)
_COUNTY_DRUG_OFFENSE_RATE = {
    "06037": ("Los Angeles County", "CA", 320.0),
    "17031": ("Cook County", "IL", 580.0),
    "48201": ("Harris County", "TX", 490.0),
    "04013": ("Maricopa County", "AZ", 420.0),
    "06073": ("San Diego County", "CA", 340.0),
    "06059": ("Orange County", "CA", 260.0),
    "12086": ("Miami-Dade County", "FL", 410.0),
    "48113": ("Dallas County", "TX", 470.0),
    "36047": ("Kings County", "NY", 290.0),
    "06065": ("Riverside County", "CA", 380.0),
    "04019": ("Pima County", "AZ", 480.0),
    "36081": ("Queens County", "NY", 220.0),
    "26163": ("Wayne County", "MI", 610.0),
    "06071": ("San Bernardino County", "CA", 440.0),
    "53033": ("King County", "WA", 350.0),
    "12011": ("Broward County", "FL", 370.0),
    "48029": ("Bexar County", "TX", 430.0),
    "06001": ("Alameda County", "CA", 310.0),
    "42101": ("Philadelphia County", "PA", 640.0),
    "48439": ("Tarrant County", "TX", 390.0),
    "36061": ("New York County", "NY", 310.0),
    "06085": ("Santa Clara County", "CA", 230.0),
    "12031": ("Duval County", "FL", 520.0),
    "12099": ("Palm Beach County", "FL", 380.0),
    "06067": ("Sacramento County", "CA", 400.0),
    "47157": ("Shelby County", "TN", 590.0),
    "29510": ("St. Louis City", "MO", 720.0),
    "29189": ("St. Louis County", "MO", 410.0),
    "13121": ("Fulton County", "GA", 500.0),
    "27053": ("Hennepin County", "MN", 370.0),
    "39035": ("Cuyahoga County", "OH", 530.0),
    "48141": ("El Paso County", "TX", 250.0),
    "55079": ("Milwaukee County", "WI", 560.0),
    "12057": ("Hillsborough County", "FL", 400.0),
    "37119": ("Mecklenburg County", "NC", 430.0),
    "06077": ("San Joaquin County", "CA", 460.0),
    "32003": ("Clark County", "NV", 440.0),
    "24510": ("Baltimore City", "MD", 700.0),
    "24005": ("Baltimore County", "MD", 350.0),
    "48453": ("Travis County", "TX", 340.0),
    "39049": ("Franklin County", "OH", 460.0),
    "06019": ("Fresno County", "CA", 420.0),
    "13089": ("DeKalb County", "GA", 440.0),
    "36005": ("Bronx County", "NY", 340.0),
    "12095": ("Orange County", "FL", 370.0),
    "18097": ("Marion County", "IN", 570.0),
    "39061": ("Hamilton County", "OH", 480.0),
    "51059": ("Fairfax County", "VA", 150.0),
    "48085": ("Collin County", "TX", 180.0),
    "06081": ("San Mateo County", "CA", 200.0),
    "06013": ("Contra Costa County", "CA", 290.0),
    "26125": ("Oakland County", "MI", 290.0),
    "12103": ("Pinellas County", "FL", 390.0),
    "08041": ("El Paso County", "CO", 330.0),
    "08031": ("Denver County", "CO", 450.0),
    "08001": ("Adams County", "CO", 380.0),
    "48215": ("Hidalgo County", "TX", 310.0),
    "21111": ("Jefferson County", "KY", 510.0),
    "01073": ("Jefferson County", "AL", 540.0),
    "40109": ("Oklahoma County", "OK", 560.0),
    "40143": ("Tulsa County", "OK", 520.0),
    "45091": ("York County", "SC", 320.0),
    "47037": ("Davidson County", "TN", 480.0),
    "22071": ("Orleans Parish", "LA", 650.0),
    "22033": ("East Baton Rouge Parish", "LA", 530.0),
    "51760": ("Richmond City", "VA", 540.0),
    "51810": ("Virginia Beach City", "VA", 270.0),
    "34013": ("Essex County", "NJ", 380.0),
    "34017": ("Hudson County", "NJ", 280.0),
    "34023": ("Middlesex County", "NJ", 190.0),
    "09003": ("Hartford County", "CT", 360.0),
    "09001": ("Fairfield County", "CT", 250.0),
    "25017": ("Middlesex County", "MA", 180.0),
    "25025": ("Suffolk County", "MA", 410.0),
    "25013": ("Hampden County", "MA", 390.0),
    "37183": ("Wake County", "NC", 290.0),
    "37063": ("Durham County", "NC", 450.0),
    "48355": ("Nueces County", "TX", 380.0),
    "53053": ("Pierce County", "WA", 390.0),
    "41051": ("Multnomah County", "OR", 410.0),
    "41005": ("Clackamas County", "OR", 220.0),
    "28049": ("Hinds County", "MS", 620.0),
    "05119": ("Pulaski County", "AR", 500.0),
    "01097": ("Mobile County", "AL", 480.0),
    "12001": ("Alachua County", "FL", 360.0),
    "20173": ("Sedgwick County", "KS", 430.0),
    "31055": ("Douglas County", "NE", 370.0),
    "19153": ("Polk County", "IA", 310.0),
    "46099": ("Minnehaha County", "SD", 350.0),
    "38017": ("Cass County", "ND", 280.0),
    "30111": ("Yellowstone County", "MT", 340.0),
    "56021": ("Laramie County", "WY", 320.0),
    "16001": ("Ada County", "ID", 290.0),
    "49035": ("Salt Lake County", "UT", 340.0),
    "33011": ("Hillsborough County", "NH", 270.0),
    "50007": ("Chittenden County", "VT", 250.0),
    "10003": ("New Castle County", "DE", 410.0),
    "44007": ("Providence County", "RI", 350.0),
    "15003": ("Honolulu County", "HI", 260.0),
    "02020": ("Anchorage Municipality", "AK", 430.0),
    "11001": ("District of Columbia", "DC", 550.0),
}

# Poverty rate % (Census ACS 2022)
_COUNTY_POVERTY_RATE = {
    "06037": ("Los Angeles County", "CA", 14.2),
    "17031": ("Cook County", "IL", 13.1),
    "48201": ("Harris County", "TX", 15.8),
    "04013": ("Maricopa County", "AZ", 13.5),
    "06073": ("San Diego County", "CA", 11.8),
    "06059": ("Orange County", "CA", 9.1),
    "12086": ("Miami-Dade County", "FL", 16.5),
    "48113": ("Dallas County", "TX", 15.3),
    "36047": ("Kings County", "NY", 19.2),
    "06065": ("Riverside County", "CA", 13.4),
    "04019": ("Pima County", "AZ", 18.1),
    "36081": ("Queens County", "NY", 12.6),
    "26163": ("Wayne County", "MI", 23.1),
    "06071": ("San Bernardino County", "CA", 14.8),
    "53033": ("King County", "WA", 9.2),
    "12011": ("Broward County", "FL", 11.7),
    "48029": ("Bexar County", "TX", 15.6),
    "06001": ("Alameda County", "CA", 10.3),
    "42101": ("Philadelphia County", "PA", 22.8),
    "48439": ("Tarrant County", "TX", 10.8),
    "36061": ("New York County", "NY", 15.0),
    "06085": ("Santa Clara County", "CA", 7.0),
    "12031": ("Duval County", "FL", 14.6),
    "12099": ("Palm Beach County", "FL", 11.2),
    "06067": ("Sacramento County", "CA", 14.5),
    "47157": ("Shelby County", "TN", 19.8),
    "29510": ("St. Louis City", "MO", 24.2),
    "29189": ("St. Louis County", "MO", 9.8),
    "13121": ("Fulton County", "GA", 14.1),
    "27053": ("Hennepin County", "MN", 11.2),
    "39035": ("Cuyahoga County", "OH", 17.5),
    "48141": ("El Paso County", "TX", 20.1),
    "55079": ("Milwaukee County", "WI", 19.4),
    "12057": ("Hillsborough County", "FL", 12.9),
    "37119": ("Mecklenburg County", "NC", 11.5),
    "06077": ("San Joaquin County", "CA", 16.0),
    "32003": ("Clark County", "NV", 12.8),
    "24510": ("Baltimore City", "MD", 21.8),
    "24005": ("Baltimore County", "MD", 9.4),
    "48453": ("Travis County", "TX", 11.3),
    "39049": ("Franklin County", "OH", 15.0),
    "06019": ("Fresno County", "CA", 22.4),
    "13089": ("DeKalb County", "GA", 13.8),
    "36005": ("Bronx County", "NY", 27.3),
    "12095": ("Orange County", "FL", 12.4),
    "18097": ("Marion County", "IN", 17.9),
    "39061": ("Hamilton County", "OH", 14.7),
    "51059": ("Fairfax County", "VA", 5.8),
    "48085": ("Collin County", "TX", 5.1),
    "06081": ("San Mateo County", "CA", 6.4),
    "06013": ("Contra Costa County", "CA", 8.7),
    "26125": ("Oakland County", "MI", 8.2),
    "12103": ("Pinellas County", "FL", 12.1),
    "08041": ("El Paso County", "CO", 9.5),
    "08031": ("Denver County", "CO", 12.2),
    "08001": ("Adams County", "CO", 11.8),
    "48215": ("Hidalgo County", "TX", 28.6),
    "21111": ("Jefferson County", "KY", 14.8),
    "01073": ("Jefferson County", "AL", 17.6),
    "40109": ("Oklahoma County", "OK", 16.3),
    "40143": ("Tulsa County", "OK", 15.1),
    "45091": ("York County", "SC", 9.7),
    "47037": ("Davidson County", "TN", 14.4),
    "22071": ("Orleans Parish", "LA", 23.8),
    "22033": ("East Baton Rouge Parish", "LA", 18.4),
    "51760": ("Richmond City", "VA", 22.5),
    "51810": ("Virginia Beach City", "VA", 7.8),
    "34013": ("Essex County", "NJ", 14.2),
    "34017": ("Hudson County", "NJ", 14.8),
    "34023": ("Middlesex County", "NJ", 7.6),
    "09003": ("Hartford County", "CT", 12.8),
    "09001": ("Fairfield County", "CT", 8.3),
    "25017": ("Middlesex County", "MA", 7.1),
    "25025": ("Suffolk County", "MA", 17.3),
    "25013": ("Hampden County", "MA", 17.8),
    "37183": ("Wake County", "NC", 8.8),
    "37063": ("Durham County", "NC", 14.2),
    "48355": ("Nueces County", "TX", 17.5),
    "53053": ("Pierce County", "WA", 10.8),
    "41051": ("Multnomah County", "OR", 13.5),
    "41005": ("Clackamas County", "OR", 7.4),
    "28049": ("Hinds County", "MS", 27.1),
    "05119": ("Pulaski County", "AR", 17.2),
    "01097": ("Mobile County", "AL", 19.5),
    "12001": ("Alachua County", "FL", 20.8),
    "20173": ("Sedgwick County", "KS", 13.5),
    "31055": ("Douglas County", "NE", 10.8),
    "19153": ("Polk County", "IA", 11.5),
    "46099": ("Minnehaha County", "SD", 10.2),
    "38017": ("Cass County", "ND", 9.8),
    "30111": ("Yellowstone County", "MT", 11.4),
    "56021": ("Laramie County", "WY", 9.6),
    "16001": ("Ada County", "ID", 10.1),
    "49035": ("Salt Lake County", "UT", 9.5),
    "33011": ("Hillsborough County", "NH", 7.2),
    "50007": ("Chittenden County", "VT", 10.3),
    "10003": ("New Castle County", "DE", 12.4),
    "44007": ("Providence County", "RI", 14.7),
    "15003": ("Honolulu County", "HI", 8.5),
    "02020": ("Anchorage Municipality", "AK", 9.2),
    "11001": ("District of Columbia", "DC", 15.3),
}

# Median household income (Census ACS 2022)
_COUNTY_MEDIAN_INCOME = {
    "06037": ("Los Angeles County", "CA", 75235),
    "17031": ("Cook County", "IL", 72231),
    "48201": ("Harris County", "TX", 63802),
    "04013": ("Maricopa County", "AZ", 72850),
    "06073": ("San Diego County", "CA", 88240),
    "06059": ("Orange County", "CA", 104419),
    "12086": ("Miami-Dade County", "FL", 57815),
    "48113": ("Dallas County", "TX", 62081),
    "36047": ("Kings County", "NY", 66850),
    "06065": ("Riverside County", "CA", 73260),
    "04019": ("Pima County", "AZ", 55950),
    "36081": ("Queens County", "NY", 75805),
    "26163": ("Wayne County", "MI", 45450),
    "06071": ("San Bernardino County", "CA", 70287),
    "53033": ("King County", "WA", 110586),
    "12011": ("Broward County", "FL", 64588),
    "48029": ("Bexar County", "TX", 59672),
    "06001": ("Alameda County", "CA", 112017),
    "42101": ("Philadelphia County", "PA", 49127),
    "48439": ("Tarrant County", "TX", 74513),
    "36061": ("New York County", "NY", 93651),
    "06085": ("Santa Clara County", "CA", 140258),
    "12031": ("Duval County", "FL", 58310),
    "12099": ("Palm Beach County", "FL", 72285),
    "06067": ("Sacramento County", "CA", 73648),
    "47157": ("Shelby County", "TN", 52395),
    "29510": ("St. Louis City", "MO", 45782),
    "29189": ("St. Louis County", "MO", 68745),
    "13121": ("Fulton County", "GA", 72410),
    "27053": ("Hennepin County", "MN", 82785),
    "39035": ("Cuyahoga County", "OH", 52137),
    "48141": ("El Paso County", "TX", 49530),
    "55079": ("Milwaukee County", "WI", 49850),
    "12057": ("Hillsborough County", "FL", 63815),
    "37119": ("Mecklenburg County", "NC", 72308),
    "06077": ("San Joaquin County", "CA", 66870),
    "32003": ("Clark County", "NV", 62975),
    "24510": ("Baltimore City", "MD", 52164),
    "24005": ("Baltimore County", "MD", 74127),
    "48453": ("Travis County", "TX", 85205),
    "39049": ("Franklin County", "OH", 61835),
    "06019": ("Fresno County", "CA", 55517),
    "13089": ("DeKalb County", "GA", 63850),
    "36005": ("Bronx County", "NY", 43726),
    "12095": ("Orange County", "FL", 60340),
    "18097": ("Marion County", "IN", 52168),
    "39061": ("Hamilton County", "OH", 58342),
    "51059": ("Fairfax County", "VA", 134115),
    "48085": ("Collin County", "TX", 113200),
    "06081": ("San Mateo County", "CA", 136837),
    "06013": ("Contra Costa County", "CA", 104112),
    "26125": ("Oakland County", "MI", 79512),
    "12103": ("Pinellas County", "FL", 58190),
    "08041": ("El Paso County", "CO", 75615),
    "08031": ("Denver County", "CO", 78177),
    "08001": ("Adams County", "CO", 72105),
    "48215": ("Hidalgo County", "TX", 40125),
    "21111": ("Jefferson County", "KY", 58715),
    "01073": ("Jefferson County", "AL", 52345),
    "40109": ("Oklahoma County", "OK", 55420),
    "40143": ("Tulsa County", "OK", 55785),
    "45091": ("York County", "SC", 68925),
    "47037": ("Davidson County", "TN", 64052),
    "22071": ("Orleans Parish", "LA", 45615),
    "22033": ("East Baton Rouge Parish", "LA", 52980),
    "51760": ("Richmond City", "VA", 51645),
    "51810": ("Virginia Beach City", "VA", 80215),
    "34013": ("Essex County", "NJ", 66250),
    "34017": ("Hudson County", "NJ", 74350),
    "34023": ("Middlesex County", "NJ", 96825),
    "09003": ("Hartford County", "CT", 71540),
    "09001": ("Fairfield County", "CT", 101050),
    "25017": ("Middlesex County", "MA", 113215),
    "25025": ("Suffolk County", "MA", 76130),
    "25013": ("Hampden County", "MA", 53620),
    "37183": ("Wake County", "NC", 85280),
    "37063": ("Durham County", "NC", 65810),
    "48355": ("Nueces County", "TX", 52170),
    "53053": ("Pierce County", "WA", 76215),
    "41051": ("Multnomah County", "OR", 72615),
    "41005": ("Clackamas County", "OR", 87450),
    "28049": ("Hinds County", "MS", 39820),
    "05119": ("Pulaski County", "AR", 52410),
    "01097": ("Mobile County", "AL", 47280),
    "12001": ("Alachua County", "FL", 48610),
    "20173": ("Sedgwick County", "KS", 57480),
    "31055": ("Douglas County", "NE", 68315),
    "19153": ("Polk County", "IA", 63750),
    "46099": ("Minnehaha County", "SD", 64815),
    "38017": ("Cass County", "ND", 67850),
    "30111": ("Yellowstone County", "MT", 60520),
    "56021": ("Laramie County", "WY", 63210),
    "16001": ("Ada County", "ID", 68540),
    "49035": ("Salt Lake County", "UT", 76580),
    "33011": ("Hillsborough County", "NH", 82730),
    "50007": ("Chittenden County", "VT", 75240),
    "10003": ("New Castle County", "DE", 72815),
    "44007": ("Providence County", "RI", 57350),
    "15003": ("Honolulu County", "HI", 87470),
    "02020": ("Anchorage Municipality", "AK", 79740),
    "11001": ("District of Columbia", "DC", 90842),
}


# ---------------------------------------------------------------------------
# State-level data — keyed by 2-digit state FIPS
# ---------------------------------------------------------------------------

# Gun ownership % of households (RAND Corporation state-level estimates, 2020)
_STATE_GUN_OWNERSHIP = {
    "01": ("AL", 52.8), "02": ("AK", 64.5), "04": ("AZ", 46.3),
    "05": ("AR", 57.2), "06": ("CA", 28.3), "08": ("CO", 45.1),
    "09": ("CT", 23.6), "10": ("DE", 34.2), "11": ("DC", 8.1),
    "12": ("FL", 35.3), "13": ("GA", 49.2), "15": ("HI", 14.9),
    "16": ("ID", 60.1), "17": ("IL", 27.8), "18": ("IN", 44.8),
    "19": ("IA", 43.6), "20": ("KS", 48.9), "21": ("KY", 47.9),
    "22": ("LA", 53.1), "23": ("ME", 46.8), "24": ("MD", 30.2),
    "25": ("MA", 22.6), "26": ("MI", 40.2), "27": ("MN", 42.4),
    "28": ("MS", 55.8), "29": ("MO", 48.8), "30": ("MT", 66.3),
    "31": ("NE", 46.2), "32": ("NV", 47.3), "33": ("NH", 41.1),
    "34": ("NJ", 14.7), "35": ("NM", 49.9), "36": ("NY", 19.9),
    "37": ("NC", 45.6), "38": ("ND", 55.1), "39": ("OH", 40.0),
    "40": ("OK", 54.7), "41": ("OR", 49.8), "42": ("PA", 40.7),
    "44": ("RI", 14.8), "45": ("SC", 49.4), "46": ("SD", 56.4),
    "47": ("TN", 51.6), "48": ("TX", 45.7), "49": ("UT", 46.8),
    "50": ("VT", 50.5), "51": ("VA", 44.6), "53": ("WA", 42.1),
    "54": ("WV", 58.5), "55": ("WI", 44.4), "56": ("WY", 66.2),
}

# Giffords Law Center gun law grades (2023 scorecard)
# Grade -> letter grade string
_STATE_GIFFORDS_GRADE = {
    "01": ("AL", "F"), "02": ("AK", "F"), "04": ("AZ", "F"),
    "05": ("AR", "F"), "06": ("CA", "A"), "08": ("CO", "B"),
    "09": ("CT", "A"), "10": ("DE", "B+"), "11": ("DC", "A"),
    "12": ("FL", "D"), "13": ("GA", "F"), "15": ("HI", "A"),
    "16": ("ID", "F"), "17": ("IL", "A"), "18": ("IN", "F"),
    "19": ("IA", "D-"), "20": ("KS", "F"), "21": ("KY", "F"),
    "22": ("LA", "F"), "23": ("ME", "D+"), "24": ("MD", "A-"),
    "25": ("MA", "A"), "26": ("MI", "C+"), "27": ("MN", "B+"),
    "28": ("MS", "F"), "29": ("MO", "F"), "30": ("MT", "F"),
    "31": ("NE", "D"), "32": ("NV", "B"), "33": ("NH", "D-"),
    "34": ("NJ", "A"), "35": ("NM", "C"), "36": ("NY", "A"),
    "37": ("NC", "D"), "38": ("ND", "F"), "39": ("OH", "D-"),
    "40": ("OK", "F"), "41": ("OR", "A-"), "42": ("PA", "C+"),
    "44": ("RI", "A-"), "45": ("SC", "F"), "46": ("SD", "F"),
    "47": ("TN", "F"), "48": ("TX", "F"), "49": ("UT", "D-"),
    "50": ("VT", "B-"), "51": ("VA", "B+"), "53": ("WA", "A-"),
    "54": ("WV", "F"), "55": ("WI", "D"), "56": ("WY", "F"),
}

# Giffords grade to numeric mapping (A+=12, A=11, ..., D-=1, F=0)
_GIFFORDS_NUMERIC = {
    "A+": 12, "A": 11, "A-": 10,
    "B+": 9, "B": 8, "B-": 7,
    "C+": 6, "C": 5, "C-": 4,
    "D+": 3, "D": 2, "D-": 1,
    "F": 0,
}

# Census regions (by 2-digit state FIPS)
_STATE_REGIONS = {
    "09": "Northeast", "23": "Northeast", "25": "Northeast",
    "33": "Northeast", "34": "Northeast", "36": "Northeast",
    "42": "Northeast", "44": "Northeast", "50": "Northeast",
    "17": "Midwest", "18": "Midwest", "19": "Midwest",
    "20": "Midwest", "26": "Midwest", "27": "Midwest",
    "29": "Midwest", "31": "Midwest", "38": "Midwest",
    "39": "Midwest", "46": "Midwest", "55": "Midwest",
    "01": "South", "05": "South", "10": "South",
    "11": "South", "12": "South", "13": "South",
    "21": "South", "22": "South", "24": "South",
    "28": "South", "37": "South", "40": "South",
    "45": "South", "47": "South", "48": "South",
    "51": "South", "54": "South",
    "02": "West", "04": "West", "06": "West",
    "08": "West", "15": "West", "16": "West",
    "30": "West", "32": "West", "35": "West",
    "41": "West", "49": "West", "53": "West",
    "56": "West",
}


# ---------------------------------------------------------------------------
# Getter functions — each returns a pandas DataFrame
# ---------------------------------------------------------------------------

def _dict_to_df(data: dict, value_col: str) -> pd.DataFrame:
    """Convert an embedded dict to a DataFrame with fips, county_name, state, value."""
    rows = []
    for fips, (name, state, val) in data.items():
        rows.append({"fips": fips, "county_name": name, "state": state, value_col: val})
    return pd.DataFrame(rows)


def get_county_gun_homicide_rates() -> pd.DataFrame:
    """Gun homicide rate per 100K by county (CDC WONDER, ~2020-2022)."""
    return _dict_to_df(_COUNTY_GUN_HOMICIDE, "gun_homicide_rate")


def get_county_population() -> pd.DataFrame:
    """Population by county (Census ACS 2022)."""
    return _dict_to_df(_COUNTY_POPULATION, "population")


def get_county_gini() -> pd.DataFrame:
    """Gini coefficient by county (Census ACS 2022)."""
    return _dict_to_df(_COUNTY_GINI, "gini")


def get_county_drug_offense_rate() -> pd.DataFrame:
    """Drug offense rate per 100K by county (FBI UCR, ~2020)."""
    return _dict_to_df(_COUNTY_DRUG_OFFENSE_RATE, "drug_offense_rate")


def get_county_poverty_rate() -> pd.DataFrame:
    """Poverty rate % by county (Census ACS 2022)."""
    return _dict_to_df(_COUNTY_POVERTY_RATE, "poverty_rate")


def get_county_median_income() -> pd.DataFrame:
    """Median household income by county (Census ACS 2022)."""
    return _dict_to_df(_COUNTY_MEDIAN_INCOME, "median_income")


def get_county_gun_ownership() -> pd.DataFrame:
    """Gun ownership % by county (state-level RAND proxy).

    Joins state-level gun ownership estimates to each county
    via the first 2 digits of the FIPS code.
    """
    # Get all counties from the homicide data (our canonical county list)
    counties = get_county_gun_homicide_rates()[["fips", "county_name", "state"]]
    state_own = {}
    for sfips, (_, pct) in _STATE_GUN_OWNERSHIP.items():
        state_own[sfips] = pct
    counties["gun_ownership_pct"] = counties["fips"].str[:2].map(state_own)
    return counties


def get_county_giffords_grade() -> pd.DataFrame:
    """Giffords gun law grade by county (state-level proxy).

    Returns both the letter grade and a numeric score (A+=12 ... F=0).
    """
    counties = get_county_gun_homicide_rates()[["fips", "county_name", "state"]]
    state_grade = {}
    for sfips, (_, grade) in _STATE_GIFFORDS_GRADE.items():
        state_grade[sfips] = grade
    counties["giffords_grade"] = counties["fips"].str[:2].map(state_grade)
    counties["giffords_numeric"] = counties["giffords_grade"].map(_GIFFORDS_NUMERIC)
    return counties


def get_county_regions() -> pd.DataFrame:
    """Census region by county (derived from state FIPS)."""
    counties = get_county_gun_homicide_rates()[["fips", "county_name", "state"]]
    counties["region"] = counties["fips"].str[:2].map(_STATE_REGIONS)
    return counties[["fips", "region"]]
